@page
@model LoginModel
@{
}


<h2>SignUp</h2>

<div id="SignUp">
   
   <div id="errorMessage" style="font-weight: bold; color:red"></div>

   <div id="InputParams">

      <h4>Account Info</h4>
      <ul>
         <li>
            <label>UserName:</label>
            <input type="text" param="UserName" />
            <span></span>
         </li>
         <li>
            <label>Password:</label>
            <input type="text" param="password" source="QueryString" />
            <span></span>
         </li>
         <li>
            <label>Display Name:</label>
            <input type="text" param="DisplayName" placeholder="Name Displayed" />
            <span></span>
         </li>
      </ul>

      <h4>Personal Info</h4>
      <ul>
         <li>
            <label>First Name:</label>
            <input type="text" param="FirstName" />
            <span></span>
         </li>
         <li>
            <label>Last Name:</label>
            <input type="text" param="LastName" />
            <span></span>
         </li>
         <li>
            <label>School Email:</label>
            <input type="text" param="SchoolEmail" />
            <span></span>
         </li>
         <li>
            <label>Contact Email:</label>
            <input type="text" param="ContactEmail" />
            <span></span>
         </li>
         <li>
            <label>Phone Number:</label>
            <input type="text" param="PhoneNumber" />
            <span></span>
         </li>
      </ul>


      <h4>Location Info</h4>
      <ul>
         <li>
            <label>Name:</label>
            <input type="text" param="Location.Name" placeholder="House, Apartment, etc." />
            <span></span>
         </li>
         <li>
            <label>Address:</label>
            <input type="text" param="Location.AddressLine" />
            <span></span>
         </li>
         <li>
            <label>City:</label>
            <input type="text" param="Location.Locality" />
            <span></span>
         </li>
         <li>
            <label>State:</label>
            <input type="text" param="Location.AdminDistrict" />
            <span></span>
         </li>
         <li>
            <label>Postal Code:</label>
            <input type="text" param="Location.PostalCode" />
            <span></span>
         </li>
         <li>
            <label>Country:</label>
            <input type="text" param="Location.CountryRegion" />
            <span></span>
         </li>
      </ul>

   </div>

   <br />

   <ul>
      <li>
         <label id="signUpLabel"></label>
         <input id="signUpButton" type="button" value="Create Account" />
      </li>
   </ul>

</div>

<script>

   var InputParams = document.getElementById("InputParams");
   var signUpLabel = document.getElementById("signUpLabel");
   var signUpButton = document.getElementById("signUpButton");
   var errorMessage = document.getElementById("errorMessage");

   signUpButton.addEventListener("click", function () {
      var oRequest = U.buildAjaxRequestFromInputs(InputParams.querySelectorAll("input[param]"), {
         cache: false,
         type: "POST",
         url: "webapi/account/createuser",
         data: {},
         success: handleSuccess,
         error: handleFailure
      });
      function handleSuccess(ev) {
         if (ev.success) {
            signUpButton.disabled = true;
            console.log(oRequest, ev);
            signUpLabel.value = "Success!";
            InputParams.class = "Success";
         } else {
            handleFailure(ev);
         }
      }
      function handleFailure(ev) {
         console.log(oRequest, ev);
         signUpLabel.value = "Failed!";
         InputParams.class = "Failed";
         errorMessage.innerText = ev.message;
      }

      $.ajax(oRequest);
   });
</script>

